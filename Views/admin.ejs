<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans antialiased p-6">

  <h1 class="text-4xl font-extrabold text-gray-800 mb-6 text-center">Admin Dashboard</h1>

  <div class="overflow-x-auto bg-white shadow-lg rounded-lg">
    <table class="w-full text-sm text-left border-collapse">
      <thead class="text-gray-700 uppercase bg-gray-200">
        <tr>
          <th scope="col" class="py-3 px-4 rounded-tl-lg">Title</th>
          <th scope="col" class="py-3 px-4">Location</th>
          <th scope="col" class="py-3 px-4">Status</th>
          <th scope="col" class="py-3 px-4">Reporter</th>
          <th scope="col" class="py-3 px-4 rounded-tr-lg text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% posts.forEach(post => { %>
          <tr class="bg-white border-b hover:bg-gray-50">
            <td class="py-4 px-4 font-medium text-gray-900"><%= post.title %></td>
            <td class="py-4 px-4 text-gray-600"><%= post.location %></td>
            <td class="py-4 px-4">
              <span class="
                <%= post.status === 'Resolved' ? 'bg-green-100 text-green-800' :
                    post.status === 'In Progress' ? 'bg-blue-100 text-blue-800' :
                    'bg-yellow-100 text-yellow-800' %>
                text-xs font-semibold px-2.5 py-0.5 rounded-full capitalize
              ">
                <%= post.status %>
              </span>
            </td>
            <td class="py-4 px-4 text-gray-600"><%= post.reporter ? post.reporter.email : "Anonymous" %></td>
            <td class="py-4 px-4 text-center">
              <div class="flex flex-col md:flex-row md:space-x-2 space-y-2 md:space-y-0 items-center justify-center">
                <form action="/admin/update/<%= post._id %>" method="POST" class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 items-center">
                  <input type="text" name="title" value="<%= post.title %>" class="border border-gray-300 rounded-lg p-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full md:w-auto" />
                  <input type="text" name="location" value="<%= post.location %>" class="border border-gray-300 rounded-lg p-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full md:w-auto" />
                  <select name="status" class="border border-gray-300 rounded-lg p-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full md:w-auto">
                    <option value="Pending" <%= post.status==="Pending"?"selected":"" %>>Pending</option>
                    <option value="In Progress" <%= post.status==="In Progress"?"selected":"" %>>In Progress</option>
                    <option value="Resolved" <%= post.status==="Resolved"?"selected":"" %>>Resolved</option>
                  </select>
                  <button type="submit" class="bg-blue-500 text-white font-semibold py-1.5 px-3 rounded-lg hover:bg-blue-600 transition-colors duration-200 w-full md:w-auto">
                    Update
                  </button>
                </form>

                <form action="/admin/delete/<%= post._id %>" method="POST" class="mt-2 md:mt-0">
                  <button type="submit" onclick="return confirm('Delete this post?')" class="bg-red-500 text-white font-semibold py-1.5 px-3 rounded-lg hover:bg-red-600 transition-colors duration-200 w-full md:w-auto">
                    Delete
                  </button>
                </form>
              </div>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</body>
</html>